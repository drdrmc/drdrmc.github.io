---
layout: post
title: On things end-to-end
date: '2017-08-02T14:15:00.002+01:00'
author: Mac
tags: 
modified_time: '2017-08-03T10:15:06.375+01:00'
blogger_id: tag:blogger.com,1999:blog-2071817123910236284.post-6404898111501084834
blogger_orig_url: http://drdrmc.blogspot.com/2017/08/on-things-end-to-end.html
---

The latest from the UK Home Secretary on "end-to-end encryption" and the responses make me feel the need to explain some things cryptographic and historical.<br /><br />Modern secure messaging apps and services provide several functions:<br /><br /><ol><li>I can find people - they provide a directory, where often the primary identity is simply the phone number;</li><li>They provide a private and easy way to exchange encryption keys;</li><li>They utilise state of the art, and publicly documented encryption protocols between the end points;</li><li>And, since&nbsp;<i>we lost end-to-end networking </i>for most users<i>,&nbsp;</i>they implement a network forwarding service.</li></ol><br />My observation of the popular use of the phrase "ene-to-end encryption" is that often folks mean both functions 2 &amp; 3 - that is both private key exchange as well as use of state of the art encryption between the end points. Hence as a technical pedant, I find myself peeved by much discussion on this topic which confounds and confuses these two functions, so I have felt compelled to write this post!<br /><br />The directory service is technically the most boring but actually a very useful element of such a service; one route to finding friends is simply that the smart phone app reads your contacts and makes connections by looking for matching phone numbers already using the service. Compared to the suggestions we build a&nbsp;<a href="https://en.wikipedia.org/wiki/Web_of_trust" style="text-size-adjust: auto;" target="_blank">web of trust&nbsp;</a><span style="text-size-adjust: auto;">&nbsp;it's a heck of a lot simpler to use!</span><br /><br />Many of these apps (including WhtsApp) implement a very cunning state of the art key exchange algorithm as developed by&nbsp;<a href="https://whispersystems.org/">Open Whispers Systems</a>&nbsp;and widely available in their&nbsp;<i>open source&nbsp;</i>[1]&nbsp;<a href="https://en.wikipedia.org/wiki/Signal_(software)">Signal</a>&nbsp;app. This allows two parties who wish to communicate to share an key with which to encrypt their message without the service provider knowing the key. As noted by in the <a href="https://www.theregister.co.uk/2017/08/01/amber_rudd_on_encryption/?mt=1501673843411">excellent article </a>by <a href="https://twitter.com/kierenmccarthy">Kieren McCarthy</a>:<br /><blockquote class="tr_bq">...companies like Facebook, Google, Apple and so on could redesign their systems to make it possible to decrypt them. They could even avoid the problem of a simple backdoor by using  constantly changing encryption keys – so long as they keep a copy of  those keys.</blockquote>The desired point of intervention is the key exchange protocol, it would be straightforward to arrange that only for those targeted for surveillance, the keys and messages are kept. Doing this on a per service and per target basis is not the end of the Internet, of secure banking, of eCommerce, etc. However, it is a backdoor - bad'uns will try and attack it of course and it is a risk. That said, all the public key and certificate infrastructure that underpins session key exchange for https, and hence the majority of the Internet services we use, rely on keeping the secret half of the public/private key pair secure - that's a even juicer target for bad'uns - grab that and they can subvert the service not just a single conversation... &nbsp;So we do need some perspective on the hacking risk.<br /><br />Importantly the point of intervention is not the encryption algorithm itself - here again I find myself peeved when I hear the statement "it is against the laws of mathematics". Not really - we could simply be relying on our mathematical ignorance. Currently we think the cryptanalysis of our modern crypto algorithms is too hard (that is computationally hard and hence expensive) - we haven't proved it is mathematically, maybe we just haven't figured it out yet [2] - indeed therein lies the history of cryptanalysis! We didn't know about&nbsp;<a href="http://theamazingking.com/crypto-diff.php">differential cryptanalysis</a>&nbsp;for years...<br /><br />It is worthy of note that where is a need for encryption between two parties but with recoverable key exchange, protocols have been designed specifically to provide this - for example, MIKEY-SAKKE was&nbsp;<a href="https://www.ncsc.gov.uk/articles/development-mikey-sakke">designed</a>&nbsp;to provide the ability for an organization to deploy end-to-end encryption but also allow for that organization to acquire the keys and decode the messages, specifically where there is a regulatory requirement to do so. Examples cited include emergency services or financial services - or maybe we should just trust the bankers not to collude on price fixing, that has always worked well.<br /><div><br /></div>However, the key point of Kieren's article that resonates is that governments have simply shown themselves to be untrustworthy, and on that, there is no going back. To be clear though, as a professional paranoid, I don't understand why we trust the companies either - WhatsApp could be saying they do "end-to-end encryption", but since their code is not open to independent review, how would we know? If you are serious about your privacy check out the <a href="https://www.eff.org/node/82654">EFF Secure Messaging Scorecard </a>- me, I trust <a href="https://whispersystems.org/">Signal</a>.<br /><br class="Apple-interchange-newline" />So far, so current affairs; but I think we should analyse how we got here and where we might go. The root of this evil is in fact that we lost end-to-end networking.<br /><br />1981 was a key year for the Internet; growing from the experience of years of research on Arpanet, it saw the release of&nbsp;<a href="https://www.rfc-editor.org/rfc/pdfrfc/rfc791.txt.pdf">RFC 791</a>&nbsp;which defined IPv4,&nbsp;the Internet Protocol we still live with today, and indeed for many is the only supported network level protocol [3]. The philosophy was encapsulated in "the End-to-End Argument" as extolled in the&nbsp;<a href="http://web.mit.edu/Saltzer/www/publications/endtoend/endtoend.pdf">seminal paper</a>&nbsp;by Saltzer, Reed and Clark [4]. Importantly underpinning the idea was that computers could all speak to each other if they were connected to the Internet, indeed in defining the IPv4 address:<br /><blockquote class="tr_bq">"Internet addresses distinguish sources and destinations to the host level and provide a protocol field as well. &nbsp;It is assumed that each protocol will provide for whatever multiplexing is necessary within a host."&nbsp;</blockquote>However, we lost the plot on this. In general my 4G/wifi roaming smart phone "on the Internet" cannot speak to my home computer "on the Internet" directly - we built a series of network level mechanisms in the home, in broadband infrastructure and in mobile networks that broke the end-to-end network connectivity. Today we require most interaction between two users to be via "over-to-top" service providers, so nearly everything is now mediated by the behemoths of our era - Google, Facebook, Twitter, ... Furthermore, it is in the commercial interests of these companies to continue be mediate communication and that applies to WhatsApp too. And it's getting worse - most of the IoT kit does the same.<br /><br />This then leads to the current regulatory situation - if you provide a service, an app, and forward most of the messages, you are going to be seen as a plausible target for regulation, and in particular a single point at which someone might require key escrow on demand.<br /><br />However, the day will come when someone tweaks and releases the open source Signal app to not use the Signal service, rather a combination of direct SMS messages and an end-to-end network layer like IPv6 [5], and all the regulating of these service providers will have been an exercise in futility.<br /><br /><div style="margin: 0px; text-size-adjust: auto;">Anyway, whether you believe that or not, can you at least be clear when talking about “end-to-end encryption” to separate the issues of key handling and actual encryption.</div><div style="margin: 0px; text-size-adjust: auto;"><br /></div><div style="margin: 0px; text-size-adjust: auto;">---- 8 ----</div><div style="margin: 0px; text-size-adjust: auto;"><br /></div>[1] As is repeatedly pointed out, the cat is out of the bag - the technology is freely available as open source for anyone to use...<br />[2] I promise not to create any more theorems, so let me put this stake in the ground - I have a proof concerning factoring large numbers but it is too large to fit in the margin.<br />[3] Recent reports indicate IPv6 is over 15% of all Internet traffic, but it has yet to achieve wide-scale deployment at the edge of the network, and hence be accessible to most end users.<br />[4] Saltzer, J. H., D. P. Reed, and D. D. Clark (1981) "End-to-End Arguments in System Design". In: Proceedings of the Second International Conference on Distributed Computing Systems. Paris, France. April 8–10, 1981. IEEE Computer Society, pp. 509-512.<br />[5] Possible 3rd year undergraduate project I think.<br /><br /><div style="-webkit-text-stroke-width: 0px; color: black; font-family: Times; font-size: medium; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-decoration-color: initial; text-decoration-style: initial; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"></div><br /><div style="-webkit-text-stroke-width: 0px; color: black; font-family: Times; font-size: medium; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: normal; letter-spacing: normal; margin: 0px; orphans: 2; text-align: start; text-decoration-color: initial; text-decoration-style: initial; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><br /></div><br />